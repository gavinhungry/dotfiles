#!/bin/bash

purple_get_status() {
  purple-remote getstatus
}

purple_set_status() {
  purple-remote "setstatus?status=$1"
}

case $1 in
  lock)
    [ "$(purple_get_status)" == "available" ] && purple_set_status away
  ;&

  logout)
    "$HOME"/bin/gpg-lock
    "$HOME"/bin/keyring-lock
  ;;

  unlock)
    [ "$(purple_get_status)" == "away" ] && purple_set_status available
    xmodmap ~/.Xmodmap
  ;;
esac
